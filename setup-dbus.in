#!/bin/sh

#########################################################################################
# PROGRAM METADATA
#########################################################################################

PROGRAM=$(basename "$0")
PROGRAM_DIR=@PROGRAM_DIR@
VERSION=@VERSION@

#########################################################################################
# PROGRAM DEPENDENCIES
#########################################################################################

. "@LIB_DIR@/libusralpine.sh"

#########################################################################################
# PROGRAM 
#########################################################################################

header "$PROGRAM"

step "adding dbus"
apk add dbus dbus-openrc || error "dbus setup failed" && exit 1

step "adding dbus service to default"
if ! rc-update add dbus default; then 
    step "deleting dbus"
    apk del dbus dbus-openrc
    exit 1
fi

step "starting dbus service"
rc-service dbus start