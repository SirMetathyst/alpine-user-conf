#!/bin/sh

if id -u -ne 0 ; then
   echo "this script must be run as root"
   exit 1
fi

#########################################################################################
# PROGRAM METADATA
#########################################################################################

PROGRAM=$(basename "$0")
PROGRAM_DIR=@PROGRAM_DIR@
VERSION=@VERSION@

#########################################################################################
# PROGRAM DEPENDENCIES
#########################################################################################

. "@LIB_DIR@/libusralpine.sh"

#########################################################################################
# PROGRAM 
#########################################################################################

header "$PROGRAM"

step "adding dbus"
apk add dbus dbus-openrc || die "dbus setup - failed to install dbus"

step "adding dbus service to default"
rc-update add dbus default || die "dbus setup - failed to add service to default"

step "starting dbus service"
rc-service dbus start || warn "dbus setup - failed to start dbus service. please run manually."