#!/bin/sh

#########################################################################################
# PROGRAM METADATA
#########################################################################################

PROGRAM=$(basename "$0")
PROGRAM_DIR=@PROGRAM_DIR@
VERSION=@VERSION@

#########################################################################################
# PROGRAM DEPENDENCIES
#########################################################################################

. "@LIB_DIR@/libusralpine.sh"

#########################################################################################
# PROGRAM 
#########################################################################################

header "$PROGRAM"

step "adding dbus"
apk add dbus dbus-openrc || die "dbus setup - failed to install dbus"

rc-update add dbus default \
    || step "deleting dbus" \
    && apk del dbus dbus-openrc \
    && die "dbus setup - failed to start service"

step "starting dbus service"
rc-service dbus start \
    || warn "dbus setup - failed to start dbus service. please run manually."